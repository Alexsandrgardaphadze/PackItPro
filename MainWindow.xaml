<Window x:Class="PackItPro.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:views="clr-namespace:PackItPro.Views"
        xmlns:vm="clr-namespace:PackItPro.ViewModels"
        mc:Ignorable="d"
        Title="PackItPro - Secure Package Builder" 
        Height="650" Width="1050"
        Background="{StaticResource AppBackgroundColor}"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        MinWidth="900" MinHeight="600"
        Loaded="Window_Loaded">

    <Window.DataContext>
        <vm:MainViewModel />
    </Window.DataContext>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Menu Bar -->
            <RowDefinition Height="*"/>
            <!-- Main Content -->
            <RowDefinition Height="Auto"/>
            <!-- Status Panel -->
            <RowDefinition Height="Auto"/>
            <!-- Bottom Progress Bar -->
        </Grid.RowDefinitions>

        <!-- MENU BAR (Preserved) -->
        <Menu Grid.Row="0" Background="{StaticResource AppBackgroundColor}" Padding="0,6" Margin="0,0,0,12">
            <MenuItem Header="File" Foreground="{StaticResource AppTextColor}" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="Add Files..." Command="{Binding BrowseFilesCommand}" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="Clear All Files" Command="{Binding ClearAllFilesCommand}" Style="{StaticResource SubMenuItemStyle}"/>
                <Separator Background="{StaticResource AppBorderColor}"/>
                <MenuItem Header="Export Logs..." Command="{Binding ExportLogsCommand}" Style="{StaticResource SubMenuItemStyle}"/>
                <Separator Background="{StaticResource AppBorderColor}"/>
                <MenuItem Header="Exit" Command="{Binding ExitCommand}" Style="{StaticResource SubMenuItemStyle}"/>
            </MenuItem>
            <MenuItem Header="Settings" Foreground="{StaticResource AppTextColor}" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="Output Location..." Command="{Binding SetOutputLocationCommand}" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="VirusTotal API Key..." Command="{Binding SetVirusApiKeyCommand}" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="PackItPro Settings..." Command="{Binding PackItProSettingsCommand}" Style="{StaticResource SubMenuItemStyle}"/>
            </MenuItem>
            <MenuItem Header="Tools" Foreground="{StaticResource AppTextColor}" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="Test Package..." Command="{Binding TestPackageCommand}" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="View Cache..." Command="{Binding ViewCacheCommand}" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="Clear Cache" Command="{Binding ClearCacheCommand}" Style="{StaticResource SubMenuItemStyle}"/>
                <Separator Background="{StaticResource AppBorderColor}"/>
                <MenuItem Header="Export List..." Command="{Binding ExportListCommand}" Style="{StaticResource SubMenuItemStyle}"/>
            </MenuItem>
            <MenuItem Header="Help" Foreground="{StaticResource AppTextColor}" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="Documentation" Command="{Binding DocumentationCommand}" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="GitHub Repository" Command="{Binding GitHubCommand}" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="Report Issue" Command="{Binding ReportIssueCommand}" Style="{StaticResource SubMenuItemStyle}"/>
                <Separator Background="{StaticResource AppBorderColor}"/>
                <MenuItem Header="Check for Updates" Command="{Binding CheckUpdatesCommand}" Style="{StaticResource SubMenuItemStyle}"/>
                <Separator Background="{StaticResource AppBorderColor}"/>
                <MenuItem Header="About PackItPro" Command="{Binding AboutCommand}" Style="{StaticResource SubMenuItemStyle}"/>
            </MenuItem>
        </Menu>

        <!-- MAIN CONTENT AREA (With Scrollable Right Panel) -->
        <Grid Grid.Row="1" Margin="0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>

            <!-- File List Panel (Left) -->
            <views:FileListPanel Grid.Column="0" Margin="0,0,10,0" DataContext="{Binding FileList}" />

            <!-- SCROLLABLE RIGHT PANEL (Settings + Summary) -->
            <ScrollViewer Grid.Column="1" 
                          VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Disabled"
                          Margin="0,0,0,0">
                <StackPanel>
                    <views:PackSettingsPanel DataContext="{Binding Settings}" Margin="0,0,0,10"/>
                    <views:SummaryPanel DataContext="{Binding Summary}" />
                </StackPanel>
            </ScrollViewer>
        </Grid>

        <!-- STATUS PANEL -->
        <views:StatusPanel Grid.Row="2" Margin="0,0,0,8" DataContext="{Binding Status}" />

        <!-- BOTTOM PROGRESS BAR -->
        <ProgressBar Grid.Row="3"
                     Value="{Binding Status.ProgressPercentage}"
                     Style="{StaticResource RoundedProgressBarStyle}"/>
    </Grid>
</Window>