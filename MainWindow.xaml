<Window x:Class="PackItPro.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PackItPro"
        xmlns:views="clr-namespace:PackItPro.Views"
        mc:Ignorable="d"
        Title="PackItPro - Secure Package Builder" Height="650" Width="1050"
        Background="{StaticResource AppBackgroundColor}"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        MinWidth="900" MinHeight="600">

    <!-- Resources are now in App.xaml, so this can be empty or contain window-specific resources -->

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Menu Bar -->
            <RowDefinition Height="*"/>
            <!-- Main Content Area -->
            <RowDefinition Height="Auto"/>
            <!-- Status Area (StatusPanel will contain Pack Button & ErrorPanel) -->
            <RowDefinition Height="Auto"/>
            <!-- Bottom Progress Bar -->
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <Menu Grid.Row="0" Background="{StaticResource AppBackgroundColor}" Padding="0,6" Margin="0,0,0,12">
            <MenuItem Header="File" Foreground="{StaticResource AppTextColor}" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="Add Files..." Click="BrowseFiles_Click" InputGestureText="Ctrl+O" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="Clear All Files" Click="ClearAllFiles_Click" InputGestureText="Ctrl+Del" Style="{StaticResource SubMenuItemStyle}"/>
                <Separator Background="{StaticResource AppBorderColor}"/>
                <MenuItem Header="Export Logs..." Click="ExportLogs_Click" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="Export List..." Click="ExportList_Click" Style="{StaticResource SubMenuItemStyle}"/>
                <Separator Background="{StaticResource AppBorderColor}"/>
                <MenuItem Header="Exit" Click="Exit_Click" InputGestureText="Alt+F4" Style="{StaticResource SubMenuItemStyle}"/>
            </MenuItem>
            <MenuItem Header="Settings" Foreground="{StaticResource AppTextColor}" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="Output Location..." Click="SetOutputLocation_Click" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="VirusTotal API Key..." Click="SetVirusApiKey_Click" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="PackItPro Settings..." Click="PackItProSettings_Click" Style="{StaticResource SubMenuItemStyle}"/>
            </MenuItem>
            <MenuItem Header="Tools" Foreground="{StaticResource AppTextColor}" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="Test Package..." Click="TestPackage_Click" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="View Cache..." Click="ViewCache_Click" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="Clear Cache" Click="ClearCache_Click" Style="{StaticResource SubMenuItemStyle}"/>
                <Separator Background="{StaticResource AppBorderColor}"/>
                <MenuItem Header="Export Package List..." Click="ExportList_Click" Style="{StaticResource SubMenuItemStyle}"/>
            </MenuItem>
            <MenuItem Header="Help" Foreground="{StaticResource AppTextColor}" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="Documentation" Click="Documentation_Click" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="GitHub Repository" Click="GitHub_Click" Style="{StaticResource SubMenuItemStyle}"/>
                <MenuItem Header="Report Issue" Click="ReportIssue_Click" Style="{StaticResource SubMenuItemStyle}"/>
                <Separator Background="{StaticResource AppBorderColor}"/>
                <MenuItem Header="Check for Updates" Click="CheckUpdates_Click" Style="{StaticResource SubMenuItemStyle}"/>
                <Separator Background="{StaticResource AppBorderColor}"/>
                <MenuItem Header="About PackItPro" Click="About_Click" Style="{StaticResource SubMenuItemStyle}"/>
            </MenuItem>
        </Menu>

        <!-- Main Content Area -->
        <Grid Grid.Row="1" Margin="0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>

            <!-- File List Panel -->
            <views:FileListPanel Grid.Column="0" Margin="0,0,10,0" />

            <!-- Right Side Panel (Settings + Summary) -->
            <!-- This Grid replaces the old PackSettingsAndSummaryPanel -->
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <views:PackSettingsPanel Grid.Row="0" />
                <views:SummaryPanel Grid.Row="1" />
            </Grid>
        </Grid>

        <!-- Status Area -->
        <!-- This is the main StatusPanel. It should internally manage the Pack Button and the Error Panel. -->
        <!-- If your StatusPanel.xaml does NOT contain the Pack Button, you will need to add it there. -->
        <!-- For now, this assumes StatusPanel.xaml is the correct, single control for this area. -->
        <views:StatusPanel Grid.Row="2" Margin="0,0,0,8" />

        <!-- Bottom Progress Bar (Simplified) -->
        <Grid Grid.Row="3">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <ProgressBar Grid.Column="0"
                         x:Name="ProcessProgressBar"
                         Height="6"
                         Minimum="0"
                         Maximum="100"
                         Value="0"
                         Foreground="{StaticResource AppPrimaryColor}"
                         Background="#3A3A4D"
                         Style="{StaticResource RoundedProgressBarStyle}"/>

            <TextBlock Grid.Column="1"
                       x:Name="ProgressPercentTextBlock"
                       Text="0%"
                       Foreground="{StaticResource AppTextSecondaryColor}"
                       Margin="8,0,0,0"
                       FontFamily="Consolas"
                       VerticalAlignment="Center"/>
        </Grid>
    </Grid>
</Window>